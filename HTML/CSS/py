import pandas as pd

# Function to process the Excel data
def process_employee_data(file_path):
    # Read the Excel file into a pandas DataFrame
    df = pd.read_excel(file_path, engine='openpyxl')
    
    # Initialize counters
    overtime_count = 0
    leave_count = 0
    undertime_count = 0
    
    # Loop through each row to evaluate overtime, leave, and undertime
    for index, row in df.iterrows():
        # Skip rows where task is a weekend day (SATURDAY) or leave
        if row['Task Listings'] == 'SATURDAY' or row['Hours'] == 0:
            leave_count += 1
            continue
        
        # Check for overtime: if hours > 6
        if row['Hours'] > 6:
            overtime_count += 1
        
        # Check for undertime: if hours < 6
        if row['Hours'] < 6:
            undertime_count += 1
    
    # Output the results
    print(f"Employee has worked overtime on {overtime_count} days.")
    print(f"Employee has taken leave on {leave_count} days.")
    print(f"Employee has worked undertime on {undertime_count} days.")

    # Additional logic to check if more than 2 leaves are taken
    if leave_count > 2:
        print("Warning: Employee has taken more than 2 leave days.")
    if undertime_count > 0:
        print(f"Warning: Employee has worked undertime on {undertime_count} days.")
        
# Example of running the function
file_path = 'Rpa-employee.xlsx'  # Replace with the actual file path
process_employee_data(file_path)
